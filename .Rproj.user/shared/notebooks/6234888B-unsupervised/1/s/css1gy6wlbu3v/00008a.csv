"0","## Find first and last point for each engine"
"0","idx_first <- vapply(unique(sensor_data_smooth$Unit), function(x) min(which(sensor_data_smooth$Unit == x)), numeric(1))"
"0","idx_last <- vapply(unique(sensor_data_smooth$Unit), function(x) max(which(sensor_data_smooth$Unit == x)), numeric(1))  "
"0","## Compute centroids"
"0","idx_first_cent <- colMeans(pca$x[idx_first, c(1, 2)])"
"0","idx_last_cent <- colMeans(pca$x[idx_last, c(1, 2)])"
"0","## Plot data"
"0","plot(pca$x[idx_first, 1], pca$x[idx_first, 2],"
"0","     pch = 16, cex = 0.5, "
"0","     col = ""deepskyblue3"","
"0","     xlim = c(-10, 15),"
"0","     ylim = c(-3, 7),"
"0","     main = 'First (Sample 1) and last (Sample 125) for each engine',"
"0","     xlab = ""First principal component"","
"0","     ylab = ""Second principal component"")"
