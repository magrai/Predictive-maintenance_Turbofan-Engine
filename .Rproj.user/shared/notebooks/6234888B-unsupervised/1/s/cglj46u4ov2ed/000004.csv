"0","## All units already available in sensor_data"
"0","k <- 4"
"0","sensor_data_smooth <- c()"
"0","for (u in unique(sensor_data$Unit)) {"
"0","  data_temp <- sensor_data[sensor_data$Unit == u, variable_names]"
"0","  data_temp <- data_temp[1:125,]"
"0","  # data_temp[, 3:ncol(data_temp)] <-"
"0","  #   filter(data_temp[, 3:ncol(data_temp)],"
"0","  #          rep(1/4, 4),"
"0","  #          sides = 1)"
"0","  "
"0","  data_temp_smooth <- data_temp"
"0","  ## First value remains the same"
"0","  ## Second to kth value is truncated, and averaged over values < k"
"0","  for (i in 2:k) {"
"0","    data_temp_smooth[i, 3:ncol(data_temp_smooth)] <- "
"0","      apply(data_temp[1:i, 3:ncol(data_temp)], 2, mean)"
"0","  }"
"0","  for(i in (k+1):nrow(data_temp_smooth)) {"
"0","    data_temp_smooth[i, 3:ncol(data_temp_smooth)] <- "
"0","      apply(data_temp[(i-k):i, 3:ncol(data_temp)], 2, mean)"
"0","  }"
"0","  "
"0","  data_temp_smooth <- data_temp_smooth[(k+2):nrow(data_temp_smooth), ]"
"0","  sensor_data_smooth <- rbind(sensor_data_smooth, data_temp_smooth)"
"0","}"
"0","head(sensor_data_smooth, 10)"
